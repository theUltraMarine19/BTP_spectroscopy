% for articial datasets
function img = image_creator1(dim)
img = zeros(dim(1), dim(2), dim(3));
mineral1 = [9.1297, 9.130600000000001, 9.148, 9.2026, 9.1893, 9.1996, 9.2026, 9.1706, 8.875599999999999, 7.986000000000001, 6.6249, 5.324999999999999, 4.2878, 3.4939, 2.9031000000000002, 2.4645, 2.1422, 1.9064999999999999, 1.7323999999999997, 1.6077, 1.5185, 1.4529, 1.4058, 1.3727, 1.3533, 1.3527, 1.375, 1.4158, 1.4405999999999999, 1.4806, 1.4819, 1.4387, 1.4391, 1.4783, 1.5449000000000002, 1.6882, 1.7368000000000001, 1.8125, 1.9677, 1.9067, 1.795, 1.77, 1.7924, 1.7719, 1.8017999999999998, 1.9097999999999997, 1.9611, 2.2359, 2.6407, 2.7256, 2.4608999999999996, 2.1893000000000002, 1.9518000000000002, 1.7878, 1.7106, 1.7047999999999999, 1.7306, 1.7748, 1.8218, 1.8304999999999998, 1.8047, 1.7428, 1.7157999999999998, 1.704, 1.6794000000000002, 1.6418, 1.5935000000000001, 1.5464, 1.5083000000000002, 1.478, 1.4581, 1.4491, 1.4499, 1.4684, 1.5089000000000001, 1.5359, 1.505, 1.4264999999999999, 1.3374000000000001, 1.2545, 1.1785, 1.1197, 1.0779, 1.0493999999999999, 1.0282, 1.0123, 1.0004, 0.99, 0.9773000000000001, 0.9575, 0.9314, 0.9069, 0.8894, 0.8742, 0.8618, 0.8513000000000001, 0.8436999999999999, 0.8372999999999999, 0.8316999999999999, 0.8270000000000001, 0.8217000000000001, 0.8186, 0.8158000000000001, 0.8122, 0.8094, 0.8069, 0.8041, 0.8023000000000001, 0.7990999999999999, 0.7977000000000001, 0.7949, 0.7931999999999999, 0.7909999999999999, 0.7877000000000001, 0.7868999999999999, 0.7844, 0.7814000000000001, 0.7809999999999999, 0.7788999999999999, 0.7764, 0.7747999999999999, 0.7734000000000001, 0.7719999999999999, 0.7695000000000001, 0.768, 0.7661, 0.7646999999999999, 0.7629, 0.7602, 0.7587999999999999, 0.7571000000000001, 0.7543, 0.7519, 0.7508, 0.748, 0.7454, 0.7433000000000001, 0.7408, 0.7387, 0.7356, 0.733, 0.7307, 0.7281, 0.7241, 0.722, 0.7187, 0.7159, 0.712, 0.7099, 0.707, 0.7036, 0.7023, 0.6993, 0.6971999999999999, 0.6937, 0.6921999999999999, 0.6913, 0.6877, 0.6847, 0.6805, 0.6798, 0.6752, 0.6716, 0.6674, 0.6646000000000001, 0.6624, 0.6584, 0.6554, 0.6524, 0.6509, 0.6473, 0.6443000000000001, 0.6415, 0.6405000000000001, 0.6369, 0.6335, 0.6323, 0.6315999999999999, 0.6285000000000001, 0.6266, 0.6264, 0.6227, 0.6248, 0.6232000000000001, 0.6212, 0.6199, 0.6191, 0.6213, 0.6185, 0.6155999999999999, 0.6135999999999999, 0.6108, 0.6069];
mineral2 = [1.2494, 1.2111, 1.1783000000000001, 1.1531, 1.147, 1.1604, 1.3737, 1.0909, 0.978, 0.9146000000000001, 0.8733, 0.8407, 0.8142999999999999, 0.7917000000000001, 0.774, 0.761, 0.7533, 0.7524, 0.7589, 0.7742, 0.7990999999999999, 0.8321, 0.867, 0.8895, 0.8875, 0.8594, 0.8137, 0.7668999999999999, 0.7319, 0.7087, 0.6936, 0.6838, 0.6774, 0.6728, 0.6697, 0.6673, 0.6648000000000001, 0.6632, 0.6608, 0.6587000000000001, 0.656, 0.6537999999999999, 0.6513, 0.6488999999999999, 0.6469, 0.6448, 0.643, 0.642, 0.6412, 0.6402, 0.6396999999999999, 0.6396, 0.6397999999999999, 0.6397999999999999, 0.6401, 0.6406000000000001, 0.6419, 0.6426000000000001, 0.6437, 0.6443, 0.6454000000000001, 0.6469, 0.6483, 0.6493, 0.6497999999999999, 0.6482, 0.6447, 0.64, 0.6355999999999999, 0.6342, 0.6355, 0.6388, 0.6398, 0.6408, 0.6415, 0.6406000000000001, 0.6363, 0.6298, 0.6202, 0.6093, 0.5982999999999999, 0.5964, 0.5995999999999999, 0.6069, 0.6157, 0.6192, 0.6192, 0.618, 0.6143, 0.6112, 0.6081000000000001, 0.6053999999999999, 0.6045, 0.6038, 0.6055999999999999, 0.6077, 0.6109, 0.6166, 0.6243, 0.6335, 0.6453, 0.6595, 0.6757, 0.6948, 0.7165, 0.7404, 0.7678, 0.7979, 0.8316, 0.8679000000000001, 0.9075, 0.9507, 0.9977, 1.0473, 1.1011, 1.1571, 1.2173, 1.2809, 1.3476000000000001, 1.4192, 1.494, 1.573, 1.6557, 1.7436, 1.8353000000000002, 1.9317000000000002, 2.0326, 2.1375, 2.2449, 2.3563, 2.4721, 2.5933, 2.7184, 2.8472999999999997, 2.9816000000000003, 3.1181, 3.2576, 3.3998, 3.5443999999999996, 3.6910999999999996, 3.8395, 3.9908, 4.1409, 4.292, 4.4418999999999995, 4.5914, 4.7434, 4.896, 5.0437, 5.1894, 5.334099999999999, 5.4708000000000006, 5.6114999999999995, 5.7456, 5.8694, 5.995, 6.120000000000001, 6.2347, 6.339499999999999, 6.4267, 6.5091, 6.5894, 6.655200000000001, 6.7166, 6.7721, 6.8151, 6.8576, 6.890199999999999, 6.912599999999999, 6.9351, 6.9444, 6.9548, 6.9505, 6.9437, 6.9327, 6.9148, 6.8928, 6.8574, 6.811999999999999, 6.7654, 6.719799999999999, 6.6594999999999995, 6.5855999999999995, 6.5114, 6.4288, 6.3363, 6.2219999999999995, 6.0964, 5.9597, 5.8344000000000005, 5.7097, 5.5944, 5.4733];
mineral3 = [6.3032, 6.0941, 5.8871, 5.6854000000000005, 5.486400000000001, 5.3011, 5.1187000000000005, 4.9437, 4.7732, 4.6074, 4.4478, 4.2966, 4.1519, 4.0137, 3.8808999999999996, 3.7534, 3.6292, 3.5092, 3.3951000000000002, 3.2862, 3.1820000000000004, 3.0833, 2.9885, 2.8972, 2.8083, 2.7218999999999998, 2.638, 2.5573, 2.4813, 2.4104, 2.3444, 2.2819000000000003, 2.2218999999999998, 2.163, 2.107, 2.0522, 2.0002, 1.9518, 1.9068, 1.866, 1.8275000000000001, 1.7912, 1.7566, 1.7227999999999999, 1.6905000000000001, 1.6594, 1.6299, 1.6023, 1.5753, 1.5513, 1.5286, 1.5088999999999997, 1.4890999999999999, 1.4714, 1.4541, 1.4385, 1.4226999999999999, 1.4076, 1.3925, 1.3773, 1.3638, 1.3514, 1.3408, 1.3321, 1.3245, 1.3151, 1.3075, 1.3008, 1.2937, 1.2872000000000001, 1.2804, 1.2731999999999999, 1.2662, 1.2593, 1.2524, 1.2462, 1.2397, 1.2342, 1.2278, 1.2234, 1.2216, 1.2181, 1.2165, 1.2149999999999999, 1.2122, 1.2113, 1.2086000000000001, 1.2029, 1.1985, 1.1939, 1.1886999999999999, 1.1842, 1.1797, 1.1761, 1.1734, 1.1711, 1.1678, 1.165, 1.1615000000000002, 1.1583, 1.157, 1.1576, 1.1571, 1.155, 1.1524, 1.1502999999999999, 1.15, 1.1505, 1.1495, 1.1442, 1.1396, 1.1385, 1.1351, 1.1303999999999998, 1.1256, 1.1224, 1.1214, 1.1176, 1.1133, 1.113, 1.1137, 1.1109, 1.1061, 1.1084, 1.1088999999999998, 1.1041, 1.1047, 1.1058000000000001, 1.1026, 1.1009, 1.1028, 1.0996, 1.0967, 1.0984, 1.0948, 1.0911, 1.0937999999999999, 1.088, 1.0841, 1.0848, 1.0781999999999998, 1.0762, 1.0762, 1.0694, 1.0711, 1.0695000000000001, 1.067, 1.0679, 1.0651, 1.0678, 1.0665, 1.0665, 1.0701, 1.0652, 1.0685, 1.0661, 1.0629, 1.0657, 1.0608, 1.0636999999999999, 1.0564, 1.0609, 1.0561, 1.057, 1.0551, 1.0518999999999998, 1.0542, 1.0463, 1.0508, 1.0422, 1.0483, 1.0379, 1.0424, 1.0352999999999999, 1.0354, 1.0312, 1.0324, 1.0279, 1.0290000000000001, 1.0241, 1.0262, 1.0231, 1.0247, 1.0222000000000002, 1.0245, 1.0198, 1.0199, 1.0146, 1.0181, 1.0145, 1.0214, 1.0148, 1.0218];

x_cens = [90 33 33 50];
y_cens = [92 33 17 66];
sigma = [66, 16, 8, 50];
p = [0.4 0.6 0.3 0.7];

x = 1:dim(1);
y = 1:dim(2);
[X Y] = meshgrid(x, y);

X_centered = zeros(dim(1), dim(2), 4);
Y_centered = zeros(dim(1), dim(2), 4);

for i=1:4
    X_centered(:,:,i) = X - x_cens(i);
    Y_centered(:,:,i) = Y - y_cens(i);
end


alpha1 = p(1) * exp(-(X_centered(:,:,1).^2 + Y_centered(:,:,1).^2)./(2*sigma(1).^2)) + p(2) * exp(-(X_centered(:,:,2).^2 + Y_centered(:,:,2).^2)./(2*sigma(2).^2));
alpha2 = p(3) * exp(-(X_centered(:,:,3).^2 + Y_centered(:,:,3).^2)./(2*sigma(3).^2)) + p(4) * exp(-(X_centered(:,:,4).^2 + Y_centered(:,:,4).^2)./(2*sigma(4).^2));
max1 = 2*max(alpha1(:));
max2 = 2*max(alpha2(:));
alpha1 = alpha1./max1;
alpha2 = alpha2./max2;

for i=1:dim(1)
    for j=1:dim(2)
        img(i,j,:) = alpha1(i,j).*mineral1(1:dim(3)) + alpha2(i,j).*mineral2(1:dim(3)) + (1-alpha1(i,j)-alpha2(i,j)).*mineral3(1:dim(3));
    end
end
